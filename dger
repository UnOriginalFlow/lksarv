-- Dreamyware v1.0 - Counter Blox Hub ⚡ Purple Retro Edition
-- Fixed and Optimized Version

local OrionLib = loadstring(game:HttpGet(('https://raw.githubusercontent.com/shlexware/Orion/main/source')))()
local Window = OrionLib:MakeWindow({
    Name = "Dreamyware", 
    HidePremium = false, 
    SaveConfig = true, 
    ConfigFolder = "DreamywareCBX", 
    IntroEnabled = true, 
    IntroText = "D r e a m y w a r e", 
    IntroIcon = "rbxassetid://4483345998"
})

-- Global Variables for Logic
getgenv().AimbotEnabled = false
getgenv().AimFOV = 100
getgenv().SilentAim = false
getgenv().AimPart = "Head"
getgenv().ESPEnabled = false
getgenv().Tracers = false
getgenv().ESPColor = Color3.fromRGB(139, 0, 255)
getgenv().WalkSpeedValue = 16
getgenv().NoRecoil = false

-- Services
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()
local Camera = game:GetService("Workspace").CurrentCamera

-- FOV Circle Drawing
local FOVCircle = Drawing.new("Circle")
FOVCircle.Thickness = 2
FOVCircle.NumSides = 460
FOVCircle.Filled = false
FOVCircle.Transparency = 0.7
FOVCircle.Color = getgenv().ESPColor
FOVCircle.Visible = false

-- Functions
local function GetClosestPlayer()
    local ClosestChild = nil
    local MaxDistance = getgenv().AimFOV

    for i, v in pairs(Players:GetPlayers()) do
        if v ~= LocalPlayer and v.Team ~= LocalPlayer.Team and v.Character and v.Character:FindFirstChild(getgenv().AimPart) and v.Character:FindFirstChild("Humanoid") and v.Character.Humanoid.Health > 0 then
            local ScreenPoint = Camera:WorldToScreenPoint(v.Character[getgenv().AimPart].Position)
            local VectorDistance = (Vector2.new(ScreenPoint.X, ScreenPoint.Y) - Vector2.new(Mouse.X, Mouse.Y)).Magnitude
            
            if VectorDistance < MaxDistance then
                MaxDistance = VectorDistance
                ClosestChild = v
            end
        end
    end
    return ClosestChild
end

-- Aimbot Loop
RunService.RenderStepped:Connect(function()
    FOVCircle.Radius = getgenv().AimFOV
    FOVCircle.Position = Vector2.new(Mouse.X, Mouse.Y + 36)
    FOVCircle.Color = getgenv().ESPColor
    
    if getgenv().AimbotEnabled then
        FOVCircle.Visible = true
        local Target = GetClosestPlayer()
        if Target and Target.Character and Target.Character:FindFirstChild(getgenv().AimPart) then
            if game:GetService("UserInputService"):IsMouseButtonPressed(Enum.UserInputType.MouseButton2) then
                Camera.CFrame = CFrame.new(Camera.CFrame.Position, Target.Character[getgenv().AimPart].Position)
            end
        end
    else
        FOVCircle.Visible = false
    end
end)

-- Constant Walkspeed Loop
task.spawn(function()
    while task.wait() do
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
            if LocalPlayer.Character.Humanoid.WalkSpeed ~= getgenv().WalkSpeedValue then
                LocalPlayer.Character.Humanoid.WalkSpeed = getgenv().WalkSpeedValue
            end
        end
    end
end)

-- Tabs
local Tab1 = Window:MakeTab({ Name = "Combat", Icon = "rbxassetid://4483362458" })
local Tab2 = Window:MakeTab({ Name = "Visuals", Icon = "rbxassetid://4483360976" })
local Tab3 = Window:MakeTab({ Name = "Skins", Icon = "rbxassetid://4483345998" })
local Tab4 = Window:MakeTab({ Name = "Misc", Icon = "rbxassetid://4483361427" })

-- Combat
Tab1:AddToggle({
    Name = "Aimbot (Hold Right Click)",
    Default = false,
    Callback = function(Value) getgenv().AimbotEnabled = Value end    
})

Tab1:AddSlider({
    Name = "Aim FOV",
    Min = 0, Max = 500, Default = 100,
    Color = Color3.fromRGB(139, 0, 255),
    Increment = 1, ValueName = "px",
    Callback = function(Value) getgenv().AimFOV = Value end    
})

Tab1:AddDropdown({
    Name = "Aim Part",
    Default = "Head",
    Options = {"Head", "HumanoidRootPart", "UpperTorso"},
    Callback = function(Value) getgenv().AimPart = Value end    
})

-- Visuals
Tab2:AddToggle({
    Name = "ESP Enabled",
    Default = false,
    Callback = function(Value) 
        getgenv().ESPEnabled = Value 
        -- Basic ESP toggle logic would go here
    end    
})

Tab2:AddColorpicker({
    Name = "UI/FOV Color",
    Default = Color3.fromRGB(139, 0, 255),
    Callback = function(Value) getgenv().ESPColor = Value end     
})

-- Skins (Placeholders as Skins require specific CBX Remote Spoofing)
Tab3:AddLabel("Skin Changing requires game-specific remotes.")
Tab3:AddDropdown({
    Name = "Knife Skin",
    Default = "Default",
    Options = {"Karambit Fade", "Butterfly Doppler", "M9 Bayonet", "Flip Knife"},
    Callback = function(Value) print("Skin selected: " .. Value) end    
})

-- Misc
Tab4:AddSlider({
    Name = "Walkspeed",
    Min = 16, Max = 100, Default = 16,
    Color = Color3.fromRGB(139, 0, 255),
    Increment = 1, ValueName = "spu",
    Callback = function(Value) getgenv().WalkSpeedValue = Value end    
})

Tab4:AddButton({
    Name = "Rejoin",
    Callback = function()
        game:GetService("TeleportService"):Teleport(game.PlaceId, LocalPlayer)
    end    
})

Tab4:AddButton({
    Name = "Destroy UI",
    Callback = function() OrionLib:Destroy() end
})

OrionLib:Init()
OrionLib:MakeNotification({
    Name = "Dreamyware",
    Content = "Script Loaded Successfully ⚡",
    Time = 3
})
